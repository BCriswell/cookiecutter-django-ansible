{% raw %}[uwsgi]
# master
master = true

{% for key, value in env_vars.items() %}
env = {{ key }}={{ value }}
{% endfor %}

# maximum number of processes
# simple rule is no. of cores on machine
processes = {{ ansible_processor_cores }}

# Kill unresponsive process after X sec
harakiri = 30

# reload workers after the specified amount of managed requests
max-requests = 5000

# the socket
socket = 127.0.0.1:8001

# with appropriate permissions
chmod-socket = 644
uid = www-data
gid = www-data
chown-socket = www-data

# the base directory
chdir = {{ django_root_dir }}

# Django's wsgi file
module = {{wsgi_path}}
callable = application

virtualenv = {{virtualenv_dir}}

# exit if no app can be loaded
need-app = true

# clear environment on exit
vacuum = true{% endraw %}
